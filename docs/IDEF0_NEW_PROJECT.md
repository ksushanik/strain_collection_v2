# IDEF0 модель нового проекта учёта микробиологических данных

## A-0 Контекстная диаграмма (Высший уровень)
- Функция: Управление микробиологической коллекцией
- Входы (Inputs):
  - Полевые данные об образцах (тип, вид, место, координаты, дата)
  - Характеристики штаммов (таксономия 16S, биохимия, активность и т.д.)
  - Описания и составы сред
  - Фото объектов и мест
  - Пользовательские запросы (поиск, фильтры, сортировки)
- Управления (Controls):
  - Требования заказчика по «гибкой структуре учёта» и терминологии
  - Правила конструктора кода образца
  - Стандарты микробиологических данных (справочники, допустимые значения)
  - Политики валидации данных и аудита
  - Политики безопасности (права доступа, в перспективе)
- Механизмы (Mechanisms):
  - Веб‑приложение (UI)
  - Backend API
  - База данных PostgreSQL (при необходимости PostGIS)
  - Файловое хранилище (S3/MinIO) для фото
  - Провайдер карты (Leaflet/Mapbox)
  - Пользователи‑операторы
- Выходы (Outputs):
  - Каталог образцов
  - Каталог штаммов и их характеристики
  - Справочник сред
  - Состояние хранилища (боксы/ячейки, размещения)
  - Минимальная аналитическая сводка
  - Журнал аудита

## A0 Декомпозиция верхнего уровня
- A1 Учет образцов
- A2 Учет штаммов
- A3 Учет сред
- A4 Управление хранилищем
- A5 Аналитика
- A6 Администрирование терминологии и легенды
- A7 Аудит изменений

---

## A1 Учет образцов
- Inputs:
  - Полевые данные об образце (тип, вид, место, координаты, дата)
  - Фото объекта/места
- Controls:
  - Правила конструктора кода образца (№ + тип + вид)
  - Стандарты допустимых типов (растение/животное/вода/почва)
- Mechanisms:
  - Модуль UI «Образцы», карта, загрузчик фото
  - Backend API, БД
- Outputs:
  - Записи «Образец» (каталог), код образца
  - Связи «образец → штаммы» (для отображения в карточке образца)

## A2 Учет штаммов
- Inputs:
  - Записи образцов (для связи «№ образца»)
  - Данные определения штаммов (16S, биохимия и др.)
- Controls:
  - Справочники/стандарты: грам‑окраска, амилаза, области выделения, и т.д.
- Mechanisms:
  - Модуль UI «Штаммы», Backend API, БД
  - Связи со средами, интерфейсы выбора мест хранения
- Outputs:
  - Записи «Штамм» (каталог) с характеристиками
  - Привязки «штамм → среда роста»
  - Требования к хранению (назначения в ячейки)

## A3 Учет сред
- Inputs:
  - Описания сред (название, состав)
- Controls:
  - Стандарты формата состава
- Mechanisms:
  - Модуль UI «Среды», Backend API, БД
- Outputs:
  - Справочник «Среды» (название + состав)
  - Доступ для привязок из A2 (штаммы → среда)

## A4 Управление хранилищем
- Inputs:
  - Запросы на размещение штаммов (из A2)
- Controls:
  - Политики размеров боксов (9×9 или 10×10)
  - Правило «одна ячейка → максимум один штамм»
- Mechanisms:
  - Модуль UI «Хранилище» (плитки боксов, сетка ячеек)
  - Backend API, БД
- Outputs:
  - Состояние боксов и ячеек (свободно/занято)
  - Привязки «штамм → ячейка» (включая «основная»/«неосновная»)

## A5 Аналитика
- Inputs:
  - Каталог образцов (A1), штаммов (A2), сред (A3)
  - Состояние хранилища (A4)
- Controls:
  - Конфигурация базовых метрик/отчётов
- Mechanisms:
  - Модуль UI «Аналитика», Backend API
- Outputs:
  - Сводные метрики: total_strains, total_samples, occupied/free_cells, recent_additions
  - Заглушки для расширяемых отчётов

## A6 Администрирование терминологии и легенды
- Inputs:
  - Запросы заказчика на смену структуры учёта и терминологии
- Controls:
  - Утверждённые термины и правила отображения
- Mechanisms:
  - Модуль UI «Легенда/Настройки», Backend API, БД
- Outputs:
  - Конфигурации представлений (биндинги меню к профилям)
  - Легенда, активные «пакеты полей» для разделов
  - Управляющие данные для A1–A5 (динамика представлений)

## A7 Аудит изменений
- Inputs:
  - События CRUD/привязок из A1–A4
- Controls:
  - Политика аудита и хранения журнала
- Mechanisms:
  - Сервис аудита, Backend API, БД
- Outputs:
  - Журнал аудита (операции, время, сущность, batch_id)

---

## Межфункциональные интерфейсы (потоки IDEF0)
- A6 → A1–A5 (Controls): Конфигурации представлений, легенда, активные пакеты полей
- A1 → A2 (Inputs): Каталог образцов и связи «образец → штаммы»
- A2 → A4 (Inputs): Требования к размещению штаммов (назначения)
- A3 → A2 (Inputs/Controls): Справочник сред для привязок
- A4 → A2 (Controls): Состояние доступных ячеек/боксов
- A1/A2/A3/A4 → A5 (Inputs): Источники данных для аналитики
- A1/A2/A3/A4 → A7 (Inputs): События для аудита
- A7 → Заинтересованные стороны (Outputs): Журнал аудита

## Примечания по гибкой структуре
- «Гибкость» достигается конфигурированием представлений и полей (A6), без изменения канонических моделей данных.
- Смена привязки ярлыков меню к профилям (например, «Образцы» показывают профиль «Штамм») влияет на UI/валидации, но не на схему БД.